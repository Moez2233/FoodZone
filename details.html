<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="style-main.css">
    <title>Product details</title>
</head>
<body>
    <header>
        <nav class="contanier">
            <img class="logo" src="#" alt="">
            <i id="btn-menu" class="fa-solid fa-bars"></i>
            <div class="nav-links">
                <a href="index-main.html" class="active">Home</a>
                    <a href="index-main.html">About</a>
                    <a href="index-main.html">Services</a>
                    <a href="index-main.html">Contact</a>
                    <a href="index-main.html" target="_blank">resturant</a>
                    <a href="index.html" >logout</a>
            </div>
        </nav>
    </header>
    <!-- ------------------------------------------------- -->
    <div class="container-details">
        <div class="proud-details">
            <i id="close" class="fa-solid fa-xmark"></i>
            <h2>Product Details</h2>
            <form action="" id="form">
                
                <div class="inp">
                    <i class="fa-solid fa-user"></i>
                    <input type="text" placeholder="Size Small " name="size_S" id="size_S" >
                </div>
            
                <div class="inp">
                    <i class="fa-solid fa-user"></i>
                    <input type="text" placeholder="Size Medium" name="size_M" id="size_M">
                </div>
            
                <div class="inp">
                    <i class="fa-solid fa-user"></i>
                    <input type="text" placeholder="Size Large" name="size_L" id="size_L" >
             
                </div>
    

    <div class="inp">
        <i class="fa-solid fa-user"></i>
        <input type="number" placeholder="Price Small" id="price_S" name="price_S">
    </div>

    <div class="inp">
        <i class="fa-solid fa-user"></i>
        <input type="number" placeholder="Price Medium" id="price_M" name="price_M">
    </div>

    <div class="inp">
        <i class="fa-solid fa-user"></i>
        <input type="number" placeholder="Price Large" id="price_L" name="price_L">
    </div>
    <div class="inp">

       <p style="color: white; display:inline-block;padding-right:10px;">Product</p><select id="myList1"  name="product"></select>
    
    </div>
    <button type="submit">Add Details</button>
</form>
</div>
</div>

<script>
    (function() {
        // التحقق من وجود رمز المصادقة في تخزين المحلَّل المحلي
        const token = localStorage.getItem('token');
        
        // التأكد من وجود رمز المصادقة قبل جلب البيانات
        if (token) {
          // إعداد رأس الطلب (headers) لتضمين رمز المصادقة
          const headers = {
            'Authorization': `Token ${token}`
          };
      
          // استدعاء الـ API باستخدام رأس الطلب المعدَّل
          fetch('http://127.0.0.1:8000/products/products1/', {
            headers: headers
          })
            .then(response => response.json())
            .then(data => {
              const myList = document.querySelector('#myList1');
              data.results.forEach(item => {
                const option = document.createElement('option');
                option.value = item.id;
                option.text = item.name;
      
                myList.add(option);
              });
            })
            .catch(error => {
              console.error(error);
            });
        } else {
          alert('يرجى تسجيل الدخول لعرض البيانات.');
        }
      })();
      
  </script>
        
  
  <script>(function() {
    const form = document.getElementById('form');
    form.addEventListener('submit', function(e) {
      e.preventDefault();
  
      
  
      const payload = new FormData(form);
  
      // Get the authentication token from localStorage
      const token = localStorage.getItem('token');
  
      // Check if the user is authenticated
      if (token) {
        // Include the authentication token in the request headers
        const headers = {
          'Authorization': `Token ${token}`,
        };
  
        // Post the payload using Fetch, including the headers
        fetch('http://127.0.0.1:8000/products/ProductDetails/', {
          method: 'POST',
          body: payload,
          headers: headers
        })
          .then(response => {
            if (response.ok) {
              alert('Success! Your comment has been posted.');
              window.location.href = 'categery.html'; // redirect to success page
        } else {
              throw new Error('Network response was not ok.');
            }
          })
          .catch(error => {
            console.error(error);
          });
      } else {
        alert('Please log in to post a comment.');
      }
    });
  })();
  </script>
  

    
</body>
</html>